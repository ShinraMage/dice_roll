<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Roller</title>

    <!-- Dynamic Open Graph Metadata using JavaScript-generated text -->
    <meta property="og:title" content="ðŸŽ² Dice Roll Result: Loading...">
    <meta property="og:description" content="Loading roll result... Roll your own at shinramage.github.io/dice_roll/">
    <meta property="og:url" content="https://shinramage.github.io/dice_roll/">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://shinramage.github.io/dice_roll/dice-preview.png">
    
    <!-- Twitter Card Metadata -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="ðŸŽ² Dice Roll Result: Loading...">
    <meta name="twitter:description" content="Loading roll result... Roll your own at shinramage.github.io/dice_roll/">
    <meta name="twitter:image" content="https://shinramage.github.io/dice_roll/dice-preview.png">

    <script>
        // Generate a unique result and display text based on the dice notation
        function getRollResultText() {
            const notation = window.location.search.replace('?roll=', '');
            const diceRegex = /(\d*)d(\d+)([+-]\d+)?/;
            const match = notation.match(diceRegex);
            if (!match) return null;

            const numDice = parseInt(match[1]) || 1;
            const diceSides = parseInt(match[2]);
            const modifier = parseInt(match[3]) || 0;

            // Perform dice rolls
            let rolls = [];
            for (let i = 0; i < numDice; i++) {
                rolls.push(Math.floor(Math.random() * diceSides) + 1);
            }
            const sum = rolls.reduce((a, b) => a + b, 0) + modifier;
            return `${sum} = [${rolls.join(", ")}]${modifier ? (modifier > 0 ? "+" : "") + modifier : ""}`;
        }

        document.addEventListener("DOMContentLoaded", () => {
            const resultText = getRollResultText();
            document.title = resultText ? `ðŸŽ² ${resultText}` : "Roll Dice with /3d6+5 or /d20-2";
            document.getElementById("header").textContent = resultText || "Use format like: /3d6+5 or /d20-2";
        });
    </script>

    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            margin-top: 50px;
            background-color: #f0f0f0;
        }
        #header { 
            font-size: 2em; 
            color: #333;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            display: inline-block;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <h1 id="header">Loading...</h1>
    <script>
        // Update URL based on roll parameter for different previews
        if (!window.location.search) {
            const randomNotation = `?roll=${Math.floor(Math.random() * 5 + 1)}d${Math.floor(Math.random() * 20 + 4)}`;
            history.replaceState(null, "", window.location.pathname + randomNotation);
        }
    </script>
</body>
</html>
