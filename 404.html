<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Roller</title>

    <!-- Open Graph Metadata -->
    <meta property="og:title" content="Dice Roller - Roll the Dice!">
    <meta property="og:description" content="Roll virtual dice with custom notations like 3d6+2 and see the results instantly.">
    <meta property="og:url" content="https://shinra.posetmage.com/dice_roll/">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://shinra.posetmage.com/dice_roll/default-dice-image.png">

    <!-- Twitter Card Metadata -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Dice Roller - Roll the Dice!">
    <meta name="twitter:description" content="Roll virtual dice with custom notations like 3d6+2 and see the results instantly.">
    <meta name="twitter:image" content="https://shinra.posetmage.com/dice_roll/default-dice-image.png">

    <!-- CSS for improved visuals (optional) -->
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
        #header { font-size: 2em; color: #333; }
    </style>
</head>
<body>
    <h1 id="header">Dice Roller</h1>

    <script>
        // Function to parse dice notation (e.g., "3d6+5")
        function parseDiceNotation(notation) {
            const diceRegex = /(\d*)d(\d+)([+-]\d+)?/;
            const match = notation.match(diceRegex);

            if (!match) return null;

            const numDice = parseInt(match[1]) || 1;
            const diceSides = parseInt(match[2]);
            const modifier = parseInt(match[3]) || 0;

            return { numDice, diceSides, modifier };
        }

        // Function to roll dice and calculate result
        function rollDice({ numDice, diceSides, modifier }) {
            let rolls = [];
            for (let i = 0; i < numDice; i++) {
                rolls.push(Math.floor(Math.random() * diceSides) + 1);
            }
            const sum = rolls.reduce((a, b) => a + b, 0) + modifier;
            return { sum, rolls, modifier };
        }

        // Main logic to parse the URL, calculate, and display the result
        (function() {
            const path = window.location.pathname;
            const notation = path.split("/").pop();

            const diceData = parseDiceNotation(notation);

            if (diceData) {
                const { sum, rolls, modifier } = rollDice(diceData);
                const resultText = `${sum} = [${rolls.join(", ")}]${modifier ? (modifier > 0 ? "+" : "") + modifier : ""}`;

                // Update the title, header, and Open Graph title dynamically
                document.title = resultText;
                document.getElementById("header").textContent = resultText;

                // Dynamically update Open Graph metadata
                document.querySelector('meta[property="og:title"]').setAttribute("content", resultText);
                document.querySelector('meta[property="og:description"]').setAttribute("content", `Result: ${resultText}`);
            } else {
                const errorText = "Invalid dice notation.";
                document.title = errorText;
                document.getElementById("header").textContent = errorText;
            }
        })();
    </script>
</body>
</html>
